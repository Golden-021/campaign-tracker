<!-- index.html for GitHub Pages -->
<!DOCTYPE html>
<html>
<head>
  <title>Campaign Reporting</title>
</head>
<body>
  <h2>View Reports</h2>
  <div>
    <label>Select Database:</label>
    <select id="dbDropdown"></select>
    <button onclick="fetchByDatabase()">Show</button>
  </div>
  <div>
    <label>Date Range:</label>
    <input type="date" id="fromDate">
    <input type="date" id="toDate">
    <button onclick="fetchByDate()">Show</button>
  </div>
  <div id="report"></div>
  <script>
    const scriptUrl = 'https://script.google.com/macros/s/AKfycbwKRcADsekD-6gYlyD5YNMDA0FwnaKGuSJhuFdyvwpiz9cjHvSrN5TAxp1J2zMD_NrvZg/exec';

    // Populate dropdown
    fetch(scriptUrl + '?action=getDatabaseNames')
      .then(res => res.json())
      .then(names => {
        const select = document.getElementById('dbDropdown');
        names.forEach(name => {
          const opt = document.createElement('option');
          opt.value = name;
          opt.textContent = name;
          select.appendChild(opt);
        });
      });

    function fetchByDatabase() {
      const db = document.getElementById('dbDropdown').value;
      fetch(`${scriptUrl}?action=getCampaignsByDatabase&databaseName=${encodeURIComponent(db)}`)
        .then(res => res.json())
        .then(showReport);
    }

    function fetchByDate() {
      const from = document.getElementById('fromDate').value;
      const to = document.getElementById('toDate').value;
      fetch(`${scriptUrl}?action=getCampaignsByDateRange&from=${from}&to=${to}`)
        .then(res => res.json())
        .then(showReport);
    }

    function showReport(data) {
      let html = '<table border="1"><tr><th>Database</th><th>Type</th><th>Date</th><th>Records</th><th>Leads</th></tr>';
      data.forEach(row => {
        html += `<tr>
          <td>${row.databaseName || ''}</td>
          <td>${row.campaignType}</td>
          <td>${row.date}</td>
          <td>${row.noOfRecords}</td>
          <td>${row.noOfLeads}</td>
        </tr>`;
      });
      html += '</table>';
      document.getElementById('report').innerHTML = html;
    }
  </script>
</body>
</html>
